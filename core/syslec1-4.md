# 開発に移ろう

さて、npmを使える段階になったら、使いたいパッケージのリファレンスを読み込んで、コードを書けば大体なんでも作れます。

## どういう風に作るか
基本的には、以下の図のようにサーバーが建てられていて、データをやり取りするように、作ります。具体的には、api、フロントエンドの部分は自分たちで作成をします。

間の矢印は、通信を表します。通信はもちろん通信のルールが定められますが適切に層が決められていて、低レイヤーのことを知らなくてもいいです。しかし、何を送るか、どういう形式で送るかという部分に関してはルールを決めないといけない、もしくは決められています。

具体的には、MongoDBとapiの間はMongoDBの規則でやり取りをしないといけなく、apiとフロントエンドの通信は自分たちで決められます。


## サーバーについて

まず、サーバーを建てます。Node.jsにはデフォルトで`http`というパッケージが入っていて、サーバーを建てることができます。本当は、`express`というもう少しいろいろできるパッケージをふつうは使うので、このパッケージは使わないんですが、とりあえず、`http`で建ててみることにします。

以下のコードを書いてください。

```javascript
const http = require("http");

const server = http.createServer(function (req, res) {
    res.writeHead(200, {"Content-Type": "text/plain"});
    res.end("hello, Node.js world!");
});

let port = 3000;
server.listen(port, function() {
    console.log("To view your app, open this link in your browser: http://localhost:" + port);
});
```
以上はサーバーの立場で書かれるコードであることに注意してください。

では、ユーザーとして、建てたサーバーにアクセスしましょう。ブラウザで`http://localhost:3000`にアクセスしてみてください。表示できると思います。

## どこにサーバーが建っているの？

さて、みなさんページが表示されていると思います。どこに表示されているのでしょうか。まずは、普通のウェブページがどのように表示されているかを考えましょう。

普通のウェブページを表示するために皆さんのパソコンと同じものがインターネットにつながっています。IPアドレスというビルの住所みたいなものをもとに、そのウェブページがおいてあるパソコンにアクセスします。そして、ビル（ウェブページがあるパソコン）の部屋にあたるものがポート番号です。上のコードの`3000`というところでポート番号を指定しています。

では、どのようにウェブページを見るときにアクセスしていますか？ もちろん、IPアドレスでもアクセスできます。
ためしに、[http://216.58.220.131/](http://216.58.220.131/)にアクセスしてみてください。ちゃんとつながります。

しかし、IPアドレスではアクセスせず、urlでアクセスしていると思います。実は、ブラウザはurlが入力されたときに、urlとIPアドレスの対応表を持っているサーバー（ごまかしが入っている）にアクセスするようになっています。それで、IPアドレスを取ってきて、そのサイトにアクセスできるようになります。

## localhostとは
さて、ポート番号の説明のところで、`localhost`ってなんだとなったと思います。urlなのかみたいな気持ちになります。これは、自分自身というIPアドレスに接続しているのと同じです。つまり、さっき建てたサーバーは自分のPC上に建っています。

## 通信方法について

GETとかPOSTとかという言葉を聞いたことはあるでしょうか。HTTPというプロトコルにはいくつかのメソッドが存在します。

- GET       / 指定されたURIのリソースを取り出す。
- POST      / 指定されたURIのリソースを取り出す。
- PUT       / 指定したURIにリソースを保存する。
- DELETE    / 指定したURIのリソースを削除する。

などです。GET通信はウェブページを見る際、一番最初にする通信です。
GET通信は普段ウェブページを閲覧するときにしている通信です。このおかげで、htmlファイルをurlで指定したウェブサーバーからとってくることができます。

紹介だけして、終わります。使い分けに関しては、REST APIで検索するといいかもしれません。


